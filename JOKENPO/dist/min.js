const CONFIGS={amount:200,};const randomInt=(min,max)=>Math.floor(Math.random()*(max-min+1)+min);const getPointDistance=(point1,point2)=>Math.sqrt((point1.x-point2.x)**2+(point1.y-point2.y)**2);const movePointTowards=(point,targetPoint,distance,speed)=>{const normalizedDirection={x:(targetPoint.x-point.x)/distance,y:(targetPoint.y-point.y)/distance,};return{x:point.x+normalizedDirection.x*speed,y:point.y+normalizedDirection.y*speed,};};const ENTITY_TYPES={ROCK:"rock",PAPER:"paper",SCISSOR:"scissor",WATER:"water",LOG:"log",FIRE:"fire",};const ENTITIES=({[ENTITY_TYPES.ROCK]:{group:ENTITY_TYPES.ROCK,type:ENTITY_TYPES.ROCK,kills:[ENTITY_TYPES.SCISSOR],speed:2,evolution:{minKills:7,evolution:ENTITY_TYPES.WATER},},[ENTITY_TYPES.PAPER]:{group:ENTITY_TYPES.PAPER,type:ENTITY_TYPES.PAPER,kills:[ENTITY_TYPES.ROCK],speed:2,evolution:{minKills:7,evolution:ENTITY_TYPES.LOG},},[ENTITY_TYPES.SCISSOR]:{group:ENTITY_TYPES.SCISSOR,type:ENTITY_TYPES.SCISSOR,kills:[ENTITY_TYPES.PAPER],speed:2,killsToEvolve:7,evolution:{minKills:7,evolution:ENTITY_TYPES.FIRE},},[ENTITY_TYPES.WATER]:{group:ENTITY_TYPES.ROCK,type:ENTITY_TYPES.WATER,kills:[ENTITY_TYPES.PAPER,ENTITY_TYPES.SCISSOR,ENTITY_TYPES.FIRE],speed:5,},[ENTITY_TYPES.LOG]:{group:ENTITY_TYPES.PAPER,type:ENTITY_TYPES.LOG,kills:[ENTITY_TYPES.ROCK,ENTITY_TYPES.SCISSOR,ENTITY_TYPES.WATER],speed:5,},[ENTITY_TYPES.FIRE]:{group:ENTITY_TYPES.SCISSOR,type:ENTITY_TYPES.FIRE,kills:[ENTITY_TYPES.ROCK,ENTITY_TYPES.PAPER,ENTITY_TYPES.LOG],speed:5,},});const entitiesList=([]);const entitiesTouching=(entityA,entityB)=>{return(((entityA.pointTop.x>=entityB.pointTop.x&&entityA.pointTop.x<=entityB.pointBottom.x)||(entityB.pointTop.x>=entityA.pointTop.x&&entityB.pointTop.x<=entityA.pointBottom.x))&&((entityA.pointTop.y>=entityB.pointTop.y&&entityA.pointTop.y<=entityB.pointBottom.y)||(entityB.pointTop.y>=entityA.pointTop.y&&entityB.pointTop.y<=entityA.pointBottom.y)));};const killEntity=(entity)=>{if(!entity.element)return;removeEntity(entity);entity.element=null;entitiesList.splice(entitiesList.indexOf(entity),1);};const evolveEntity=(entity)=>{if(!entity.evolution)return;if(entity.killCount>=entity.evolution.minKills){let source=ENTITIES[entity.evolution.evolution];if(source){Object.assign(entity,source);setEntityType(entity);}}};const entityKillEntity=(entityA,entityB)=>{killEntity(entityB);entityA.killCount=(entityA.killCount||0)+1;evolveEntity(entityA);};const battleContainer=document.getElementById("battle-container");const battleRect=battleContainer.getBoundingClientRect();const getEntitySize=()=>{return(battleRect.width*battleRect.height)/CONFIGS.amount**2;};const setEntityPoint=(entity,point)=>{entity.element.style.setProperty("--entity-top",`${point.y}px`);entity.element.style.setProperty("--entity-left",`${point.x}px`);const entitySize=getEntitySize();entity.pointTop=point;entity.pointBottom={x:point.x+entitySize,y:point.y+entitySize};};const setEntityType=(entity)=>{if(!entity.element)return;entity.element.className=`image`;entity.element.classList.add(entity.type);};const createEntity=(baseEntity)=>{const entitySize=getEntitySize();const element=document.createElement("DIV");element.style.setProperty("--entity-size",`${entitySize}px`);battleContainer.appendChild(element);const entity={...baseEntity,element};setEntityType(entity);setEntityPoint(entity,{x:randomInt(0,battleRect.width-entitySize),y:randomInt(0,battleRect.height-entitySize),});return entity;};const removeEntity=(entity)=>{battleContainer.removeChild(entity.element);};const clearArena=()=>{battleContainer.innerHTML="";};const getClosestTarget=(entity,entities)=>{let minDistance=Infinity;let selectedTarget=(null);entities.forEach((targetEntity)=>{entity.kills.forEach((t)=>{if(targetEntity.type===t){const distance=getPointDistance(entity.pointTop,targetEntity.pointTop);if(distance<minDistance){selectedTarget=targetEntity;minDistance=distance;}}});});return{target:selectedTarget,distance:minDistance};};const checkTouches=()=>{const freshEntities=[...entitiesList];freshEntities.forEach((entityA)=>{if(!entityA.element)return;freshEntities.forEach((entityB)=>{if(!entityB.element)return;if(entityA!==entityB&&entityA.type!==entityB.type&&entitiesTouching(entityA,entityB)){if(entityA.kills.includes(entityB.type))entityKillEntity(entityA,entityB);if(entityB.kills.includes(entityA.type))entityKillEntity(entityB,entityA);}});});};const makeEntitiesMove=()=>{entitiesList.forEach((entity)=>{const{target,distance}=getClosestTarget(entity,entitiesList);if(!target)return;setEntityPoint(entity,movePointTowards(entity.pointTop,target.pointTop,distance,entity.speed));});};let interval=(null);const start=()=>{clearArena();clearInterval(interval);for(let i=0;i<CONFIGS.amount;i++){entitiesList.push(createEntity(ENTITIES[ENTITY_TYPES.ROCK]));entitiesList.push(createEntity(ENTITIES[ENTITY_TYPES.PAPER]));entitiesList.push(createEntity(ENTITIES[ENTITY_TYPES.SCISSOR]));}interval=setInterval(()=>{checkTouches();makeEntitiesMove();const types=new Set(entitiesList.map((e)=>e.group));if(types.size===1){console.log(`${[...types][0].toUpperCase()}S WINS!`);clearInterval(interval);}},50);};start();